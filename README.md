# 2026红岩网校寒假运维考核

## 截止时间

**运维任务**：2026年1月28日 - 2026年2月8日
**开发任务**：2026年2月8日  - 2026年3月1日

## 提交方式

### 目录结构

- **运维部分**：提交到 `Ops/` 目录下
- **开发部分**：提交到 `Dev/` 目录下

### 提交流程

1. **Fork 本仓库**  
   在 GitHub 上 Fork 本仓库到你的个人账号下。

   [lulaide/Redrock-SRE-2026-Ops-Winter-Assessment: 2026 年红岩网校工作站运维安全部运维方向寒假考核](https://github.com/lulaide/Redrock-SRE-2026-Ops-Winter-Assessment)

2. **创建项目文件夹**  
   在对应题目的文件夹下创建以你的**学号命名**的项目文件夹：

   - 运维任务：`Ops/你的学号/`
   - 开发任务：`Dev/你的学号/`

3. **完成开发**  

   - **推荐方式**：直接在 Fork 仓库的项目文件夹中完成开发
   - **替代方式**：如果感觉不便，可以另外新建仓库进行开发，但请在 Fork 仓库的项目文件夹中创建 `README.md` 文件，给出你新建仓库的链接

4. **发起 Pull Request**  

   - 在运维部分和开发部分都完成后，向上游仓库（即本仓库）发起 Pull Request
   - 因为本次考核并非实际的协作项目，因此可以在最后将所有提交合并为一个 PR

### 提交内容要求

- 运维任务：提交所有相关脚本文件、配置文件及说明文档
- 开发任务：提交代码仓库链接、Docker 镜像地址、部署文档等

## 运维基础任务

本学期我们学习了Linux以及计算机网络，因此本次运维基础任务就来检验一下大家的学习成果如何

**出题人**：哦耶耶耶

### 背景

网校新上线了一批业务服务器，需要在不同网络环境下完成初始网络配置：

- 服务器要求部署在
  - 自动获取地址的办公网络
  - 业务隔离的生产网络
- 不同环境下的IP地址、子网掩码、网关、DNS配置不同
- 生产网要求**严禁访问公网**

**网络地址规划**

|          | 值              |
| -------- | --------------- |
| 网卡     | eth0            |
| IP地址   | 172.22.146.150  |
| 子网掩码 | 255.255.255.0   |
| 网段     | 172.22.146.0/24 |
| 默认网关 | 172.22.146.1    |
| 主DNS    | 172.22.146.53   |
| 备DNS    | 172.22.146.54   |

### 任务要求

请你编写一个或多个Linux下的bash脚本，完成服务器在不同网络环境下的网络配置和验证工作

### 基本要求

- **所有操作**必须通过脚本完成
- 禁止手动修改网络配置文件
- 要求脚本可重复执行、**可回滚**

### 任务一：基础网络配置

**办公网络配置**
网卡`eth0`要求使用DHCP获取网络配置，自动获取IP地址、子网掩码、默认网关以及DNS服务器

**生产网络配置**
给`eth0`配置以下的静态参数：

- IP地址：`172.22.146.150`
- 子网掩码：`255.255.255.0`
- 网段：`172.22.146.0/24`

**生产网络中系统网络配置**

- 配置网关为`172.22.146.1`
- 配置系统DNS为`172.22.146.53`和`172.22.146.54`

编写脚本支持通过参数切换网络模式

- `dhcp`:办公网络模式
- `static`:生产网络模式
- 参数不合法时输出使用说明

### 任务二：生产网络隔离

编写脚本通过修改防火墙规则或者路由策略实现生产网络访问控制

**允许访问**

- 同一内网网段地址(`172.22.146.0/24`)
- 内部网络地址(`172.16.0.0/12`)

**禁止访问**公网地址

### 任务三：自动检测与切换

处于生产网络时，每分钟检测一次eth0能否访问公网。

如果可达说明生产网络存在违规公网访问，要求能够实现自动切换回办公网络模式。

**在脚本编写的过程中，合理添加日志记录是非常重要的，它能够有效地帮助我们排查错误和定位问题。**

**因此，请在你的脚本中加入适当的日志记录机制。**

---

## 开发任务：运维监控系统

开发一个轻量级的运维监控系统，实现对关键服务和基础设施的实时监控与告警。项目参考 Uptime Kuma 的设计理念，但允许更灵活的部署形态选择。

**出题人**：[Lulaide](https://github.com/lulaide/)  
**推荐语言**：Go / Python / Rust

### 核心功能要求

### 1. 监控能力（必选）
- **HTTP(s) 监控**：检测网站可用性、响应时间、状态码
- **TCP 端口监控**：检查 TCP 端口连通性
- **Ping 监控**：ICMP ping 检测网络连通性
- **DNS 记录监控**：验证 DNS 解析是否正常

### 2. 用户界面（必选）
- 提供现代化、美观的 Web 界面
- 可视化展示监控状态和历史数据
- 响应式设计，支持移动端访问
- *前端开发可以使用 AI 辅助*

### 3. 告警通知（必选至少一种）
- **必选**：Webhook 或 Email 通知
- **可选**：QQ 机器人、Discord、Telegram 等即时通讯工具

### 4. 状态页面（必选）
- 创建公开的服务状态展示页面
- 实时显示各监控项的运行状态
- 展示历史可用性统计

### 5. 异常检测（必选）
- 状态码异常告警（如 4xx、5xx 错误）
- 响应延迟异常告警（超过阈值触发）
- 服务宕机检测
- 可配置的告警规则和阈值

### 部署形态（三选一）

### 方案一：传统服务部署
- 类似 Uptime Kuma，作为长期运行的服务
- 使用 SQLite 或其他数据库存储数据
- 适合自托管场景

### 方案二：Cloudflare Worker
- 参考 UptimeFlare 的实现方式
- 使用 Cloudflare Workers + D1/KV 存储
- 无服务器架构，免费额度充足
- 全球分布式部署

### 方案三：Serverless 定时任务
- 由定时任务（Cron）驱动执行监控
- 数据存储在云数据库
- 适合云原生场景
- 成本可控，按需扩展

### 技术要求

### 容器化（必选）
- **所有部署方案都必须提供 Docker 镜像**
- 编写 Dockerfile，确保镜像构建成功
- 镜像推送至 GHCR (GitHub Container Registry) 或 Docker Hub

### CI/CD（推荐）
- 配置 GitHub Actions 自动构建和发布
- 自动化测试（如果时间允许）
- *不会配置可以跳过，但建议尝试*

### 代码质量
- 代码结构清晰，模块化设计
- 必要的注释和文档
- 提供 README.md，包含部署说明和使用文档

### 评分标准

### 基础分（60分）
- 实现至少 3 种监控类型（HTTP/TCP/Ping/DNS）
- 基本的 Web 界面
- 至少一种告警通知方式
- 状态异常检测
- Docker 镜像构建成功

### 进阶分（30分）
- 实现所有 4 种监控类型
- 美观、现代化的前端界面
- 多种告警通知渠道
- 完善的状态页面
- 数据可视化（图表展示）
- 配置灵活性（支持自定义监控间隔、告警阈值等）

### 加分项（10分+）
- GitHub Actions 自动化部署
- 支持多种部署形态
- 单元测试覆盖
- 性能优化
- 创新功能（如证书监控、自定义检查脚本等）
- 详细的项目文档

### 提交要求

1. **代码仓库**：提交 GitHub 仓库链接
2. **Docker 镜像**：提供可拉取的镜像地址
3. **部署文档**：详细的部署和使用说明
4. **演示视频/截图**（可选）：展示系统运行效果

### 参考资源

- [Uptime Kuma](https://github.com/louislam/uptime-kuma)
- [UptimeFlare](https://github.com/lyc8503/UptimeFlare)
- Docker 官方文档
- GitHub Actions 文档

### 注意事项

- 优先实现核心功能，再考虑界面美化
- 合理使用 AI 工具辅助开发，但要理解代码逻辑
- 遇到问题及时沟通，可以参考开源项目但不要直接抄袭
- 注重代码质量和项目的可维护性

---

**祝你开发顺利！遇到技术问题欢迎交流讨论。**
